{"version":3,"sources":["../init.js"],"names":["elas","require","moment","shortid","data","async","coll","bcrypt","searchAll","then","console","log","createIndex","err","stt","deleteIndex","initData","colors","temp","count","key","key1","id","generate","name","color1","color2","color3","color4","color5","date","format","description","author","author_email","like","dislike","share","push","slice","mapSeries","merge","rs","item","cb","addCollection","error","addAuthor","hash","insertDocument","collection","id_user","addCollection2","doc1","deleteDocument","doc2","forEach","i","addLike","like1","userlogin","currentAction","update","val","updateDocument","allPallet","userPallet","isSamePallet","n","length","check","name_old","trim","toLowerCase","name_new"],"mappings":"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","file":"init.js","sourcesContent":["/*\n* Author : nguyenpham93\n* This file is to create and add data to Elasticsearch\n*/\n\nconst elas = require(\"./elastic/index\");\nconst moment = require(\"moment\");\nconst shortid = require(\"shortid\");\nconst data = require(\"./data2.json\");\nconst async = require(\"async\");\nconst coll = require(\"./models/collection\");\nconst bcrypt = require('bcrypt-nodejs');\n\n\n// Search ALl for test\nfunction searchAll (){\n\telas.searchAll(\"icolor\",\"users\")\n     .then (data => {\n        console.log(data);\n         //console.log(data.length);\n     });\n}\n//searchAll();\n\n\n//Create Index\nfunction createIndex () {\n    elas.createIndex(\"icolor\",(err,stt)=>{\n        if (err) {\n            console.log(err);\n        } else {\n            console.log(stt);\n        }\n    });\n}\n//createIndex();\n\n//Delete Index\nfunction deleteIndex () {\n    elas.deleteIndex(\"icolor\",(err, stt)=>{\n        if (err) console.log(err);\n        else console.log(stt);\n    });\n}\n//deleteIndex();\n\n// Merge Data into ElasticSearch\nfunction initData() {\n    let colors = [];\n    let temp = [];\n    for (let count in data) {\n        delete data[count].key;\n        delete data[count].key1;\n        data[count].id = shortid.generate();\n        data[count].name = data[count]['string'];\n        delete data[count][\"string\"];\n        data[count].color1 = data[count]['array'][0];\n        data[count].color2 = data[count]['array'][1];\n        data[count].color3 = data[count]['array'][2];\n        data[count].color4 = data[count]['array'][3];\n        data[count].color5 = data[count]['array'][4];\n        delete data[count][\"array\"];\n        data[count].date = moment().format(\"DD-MM-YYYY HH:mm:ss\");\n        data[count].description = \"Color collection\";\n        data[count]['id_user'] = \"SJxr4BIzb\";\n        delete data[count].author;\n        delete data[count].author_email;\n        data[count].like = 0;\n        data[count].dislike = 0;\n\n        data[count].share = 0;\n        colors.push(data[count]);\n    }\n    temp = colors.slice(20,39);\n    async.mapSeries (colors, merge, (err, rs) => {\n        console.log(rs);\n    });\n}\n\n//initData();\n\nfunction merge(item, cb){\n    coll.addCollection(item)\n    .then (data => {\n        cb(null,data);\n    },\n    error => {\n        console.log(error);\n        cb (null, error);\n    });\n}\n\n\n// Add author\nlet author = {\n    \"id\"  : 'rJBkgtYyb',\n    \"email\" : \"bluevn@gmail.com\",\n    \"password\" : \"rootvn\",\n    'facebook_id' : \"\",\n    \"facebook_access_token\" : \"\",\n    'google_id' : \"\",\n    \"google_access_token\" : \"\",\n    \"date\" :  moment().format(\"DD-MM-YYYY HH:mm:ss\")\n}\n\nfunction addAuthor (author){\n    bcrypt.hash(author['password'], null, null, function(err, hash) {\n                        author['password'] = hash;\n                        elas.insertDocument (\"icolor\", \"users\", author)\n            .then ((data) => {\n                console.log(data);\n            });\n                    });\n}\n\n//addAuthor(author);\n\nlet collection = {\n    id: shortid.generate(),\n    name: \"The Shepherd's Boy\",\n    color1: '#FE4365',\n    color2: '#036564',\n    color3: '#B38184',\n    color4: '#F77825',\n    color5: '#E6AC27',\n    date: moment().format(\"DD-MM-YYYY HH:mm:ss\"),\n    description: 'Pro color',\n    id_user: 'rJBkgtYyb',\n    like: 0,\n    dislike: 0,\n    share: 0\n}\n\nfunction addCollection2 (collection){\n    coll.addCollection(collection)\n    .then (data => {\n        console.log(data);\n    },\n    error => {\n        console.log (error);\n    });\n}\n// addCollection2(collection);\n\nlet doc1 = [\n    { id: 'Hy2Diy4-W'}\n    ];\n\nfunction deleteDocument (doc2){\n    elas.deleteDocument (\"icolor\",\"collection\", doc2)\n    .then ( data => {\n        console.log (data);\n    }, \n    err => {\n        console.log (err);\n    });\n}\ndoc1.forEach((i) => {\n    //deleteDocument(i);\n})\n\n// Add Like & Dislike\nlet like = {\n    \"id\"            : shortid.generate(),\n    \"id_collection\" : \"r1-bxZIEe-\",\n    \"id_user\"       : \"rJBkgtYyb\",\n    \"status\"        : 0,\n    \"date\"          : moment().format(\"DD-MM-YYYY HH:mm:ss\")\n}\nfunction addLike () {\n    elas.insertDocument (\"icolor\", \"like_dislike\", like)\n    .then ((data) => {\n        console.log(data);\n    });\n}\n//addLike();\n\n\n//update\nlet like1 = [\n    { id: 'SkQW2aJWb',\n      name: 'Dat',\n      color1: '#ffffff',\n      color2: '#ffff00',\n      color3: '#ff0000',\n      color4: '#000000',\n      color5: '#ff00ff',\n      date: '22-05-2017 09:24:58',\n      description: '',\n      id_user: 'r1o1n61WZ',\n      like: 0,\n      dislike: 0,\n      share: 0,\n      userlogin: 0,\n      author: 'thanhdat21293@gmail.com',\n      currentAction: '' }];\n\nfunction update (val) {\n    elas.updateDocument('icolor','collection', val);\n}\n\nlike1.forEach((i) => {\n    //update (i)\n});\n\n//update();\n\n\n\n// elas.search(\"icolor\",\"color_related\", \"#D95B43\")\n//  .then (data => {\n//      console.log(data);\n//  });\n\n// rJDog98lb\nlet allPallet = [\n    {\n        id: 'B1GkgJ3xb',\n        name: 'TD123',\n        color1: '#234567',\n        color2: '#234568',\n        color3: '#234569',\n        color4: '#234560',\n        color5: '#234561',\n        date: '19-05-2017',\n        description: '',\n        id_user: 'rJDog98lb',\n        share: 0\n    },\n    {\n        id: 'B1GkgJ3xb1',\n        name: 'TD',\n        color1: '#234567',\n        color2: '#234568',\n        color3: '#234569',\n        color4: '#234560',\n        color5: '#234561',\n        date: '19-05-2017',\n        description: '',\n        id_user: 'rJDog98lb',\n        share: 0\n    },\n];\n\nlet userPallet = {\n        id: 'rJW-xyngZ',\n        name: ' td123 ',\n        color1: '#234567',\n        color2: '#234568',\n        color3: '#234569',\n        color4: '#234560',\n        color5: '#234561',\n        date: '19-05-2017',\n        description: '',\n        id_user: 'rJDog98lb',\n        share: 0\n    };\n\nlet isSamePallet = ( allPallet , userPallet ) => {\n    let n = allPallet.length;\n    let check = 0;\n    for(let i = 0; i < n; i++){\n        let name_old = allPallet[i].name.trim().toLowerCase();\n        let name_new = userPallet.name.trim().toLowerCase();\n\n        if(name_old === name_new){\n            check = 1;\n        }\n    }\n    if(check === 1){\n        return true\n    }else{\n        return false;\n    }\n};\n\n\n// function matrixElementsSum(matrix) {\n//     for(var i = 0; i < matrix.length; i++){\n//         for(var j = 0; j < i.length; i++){\n//\n//         }\n//     }\n// }\n//\n// //console.log(matrixElementsSum([[0,1,1,2],[0,5,0,0], [2,0,3,3]]));\n// matrixElementsSum([[0,1,1,2],[0,5,0,0], [2,0,3,3]])\n\n// let test = (a, b) => {\n//     let result = 0;\n//     let nhiphanold = a.toString(2);\n//     let n2 = nhiphanold.length;\n//     nhiphanold = [...nhiphanold];\n//     nhiphanold[n2 - b] = 0;\n//     nhiphannew = nhiphanold.join(\"\");\n//     for(var i = 0; i < nhiphannew.length; i++){\n//         result += nhiphannew[i] * Math.pow(2, (n2 - i - 1));\n//     }\n//     console.log(result)\n//     //return result;\n// };\n//\n// test(37, 3);\n"]}